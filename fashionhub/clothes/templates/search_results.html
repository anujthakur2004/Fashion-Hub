{% extends "base.html" %}
{% load static %}

{% block title %}
Search Results | Fashion Hub
{% endblock title %}

{% block content %}
<style>
  .search-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 3rem 0 2rem;
    margin-bottom: 2rem;
  }
  .product-card {
    border: none;
    border-radius: 15px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    height: 100%;
  }
  .product-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  }
  .product-img {
    width: 100%;
    height: 280px;
    object-fit: cover;
  }
  .product-card .card-body {
    padding: 1.2rem;
  }
  .product-card .card-title {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #333;
  }
  .product-card .price {
    font-size: 1.25rem;
    font-weight: 700;
    color: #198754;
  }
  .btn-view {
    border-radius: 8px;
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
  }
  .no-results {
    text-align: center;
    padding: 4rem 2rem;
  }
  .no-results i {
    font-size: 5rem;
    color: #ddd;
    margin-bottom: 1.5rem;
  }
  .search-query {
    background: rgba(255,255,255,0.2);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    display: inline-block;
    font-weight: 600;
  }
</style>

<div class="search-header">
  <div class="container">
    <h2 class="mb-2">
      <i class="bi bi-search me-2"></i>Search Results
    </h2>
    {% if query %}
      <p class="mb-0">
        Showing {{ total_results }} result{{ total_results|pluralize }} for <span class="search-query">"{{ query }}"</span>
      </p>
    {% endif %}
  </div>
</div>

<div class="container mb-5">
  {% if query %}
    {% if page_obj %}
      <div class="row g-4">
        {% for product in page_obj %}
          <div class="col-sm-6 col-md-4 col-lg-3">
            <div class="card product-card">
              {% if product.images.first %}
                <img src="{{ product.images.first.image.url }}" class="product-img" alt="{{ product.name }}">
              {% else %}
                <img src="{% static 'images/placeholder.jpg' %}" class="product-img" alt="{{ product.name }}">
              {% endif %}
              <div class="card-body">
                <h5 class="card-title">{{ product.name }}</h5>
                <p class="text-muted mb-2" style="font-size: 0.85rem;">{{ product.category.name }}</p>
                <p class="price mb-3">â‚¹{{ product.price }}</p>
                <a href="{% url 'product_detail' product.slug %}" class="btn btn-outline-dark btn-sm btn-view w-100">
                  <i class="bi bi-eye me-1"></i> View Details
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if page_obj.has_other_pages %}
        <nav aria-label="Product pagination" class="mt-5">
          <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?q={{ query }}&page=1">First</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="?q={{ query }}&page={{ page_obj.previous_page_number }}">Previous</a>
              </li>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
              {% if page_obj.number == num %}
                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
              {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="page-item"><a class="page-link" href="?q={{ query }}&page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
              <li class="page-item">
                <a class="page-link" href="?q={{ query }}&page={{ page_obj.next_page_number }}">Next</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="?q={{ query }}&page={{ page_obj.paginator.num_pages }}">Last</a>
              </li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}

    {% else %}
      <div class="no-results">
        <i class="bi bi-inbox"></i>
        <h3>No products found</h3>
        <p class="text-muted">We couldn't find any products matching "{{ query }}"</p>
        <p class="text-muted">Try different keywords or browse our categories:</p>
        <div class="mt-3">
          <a href="{% url 'men' %}" class="btn btn-outline-primary me-2">Men</a>
          <a href="{% url 'women' %}" class="btn btn-outline-primary me-2">Women</a>
          <a href="{% url 'accessories' %}" class="btn btn-outline-primary">Accessories</a>
        </div>
      </div>
    {% endif %}
  {% else %}
    <div class="no-results">
      <i class="bi bi-search"></i>
      <h3>Start Searching</h3>
      <p class="text-muted">Enter a search term to find products</p>
    </div>
  {% endif %}
</div>
{% endblock content %}
